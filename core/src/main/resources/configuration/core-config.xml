<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-4.3.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-4.3.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util-3.0.xsd">
    <context:annotation-config/>
    <context:property-placeholder location="classpath:application.properties"/>

    <!-- stages configuration -->
    <import resource="classpath:configuration/stage-config.xml"/>

    <!-- application aspects -->
    <import resource="classpath:configuration/aspect-config.xml"/>

    <!-- overlap runtime configuration -->
    <import resource="classpath:configuration/overlap-runtime-config.xml"/>

    <!-- Physics configuration -->
    <bean id="physicsSettings" class="com.astro.core.engine.physics.PhysicsSettings"/>

    <!-- Box2d physics engine -->
    <bean id="physicsEngine" class="com.astro.core.engine.physics.PhysicsEngine"
          factory-method="createFromPhysicsSettings">
        <constructor-arg ref="physicsSettings"/>
    </bean>

    <!-- Loaders fo scene reader -->
    <bean id="particleEffectsLoader" class="com.astro.core.overlap_runtime.loaders.ParticleEffectsLoader"/>

    <bean id="lightsLoader" class="com.astro.core.overlap_runtime.loaders.LightsLoader">
        <property name="lightDistance" value="${renderer.light.distance}"/>
    </bean>

    <bean id="spriteAnimationsLoader" class="com.astro.core.overlap_runtime.loaders.SpriteAnimationsLoader"/>

    <bean id="labelsLoader" class="com.astro.core.overlap_runtime.loaders.LabelsLoader"/>

    <bean id="componentLoader" class="com.astro.core.overlap_runtime.loaders.ComponentLoader"/>

    <!-- Loader of all scenes -->
    <bean id="overlapSceneReader" class="com.astro.core.overlap_runtime.OverlapSceneReader" autowire="byName"/>

    <!-- Factory of the all stages in game -->
    <bean id="stageFactory" class="com.astro.core.engine.stage.StageFactory"/>

    <!-- managing game screens  -->
    <bean id="gameLogic" class="com.astro.core.engine.base.GameLogic" destroy-method="onExit">
        <property name="stageFactory" ref="stageFactory"/>
        <property name="screenConfigs">
            <util:map id="screenConfigs">
                <entry key="MAIN_MENU" value-ref="mainMenuStageConfig"/>
                <entry key="SETTINGS" value-ref="settingsStageConfig"/>
                <entry key="HIGHSCORE" value-ref="highscoreStageConfig"/>
                <entry key="LEVEL1" value-ref="level1StageConfig"/>
                <entry key="GARAGE" value-ref="garageStageConfig"/>
            </util:map>
        </property>
    </bean>

    <!-- main loop of the game -->
    <bean id="gameEngine" lazy-init="true" class="com.astro.core.engine.base.GameEngine"/>

    <bean id="playerSettings" class="com.astro.core.script.player.PlayerSettings"/>

    <bean id="playerData" lazy-init="true" class="com.astro.core.script.player.PlayerData"/>

    <bean id="box2DDebugRenderer" lazy-init="true" class="com.badlogic.gdx.physics.box2d.Box2DDebugRenderer"/>

    <bean id="gameStage" scope="prototype" class="com.astro.core.engine.stage.GameStage"/>

    <bean id="cameraManager" lazy-init="true" class="com.astro.core.engine.base.CameraManager"/>

</beans>